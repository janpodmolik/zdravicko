---
import { Icon } from 'astro-icon/components';
import { formatDateShort } from '../utils/dateFormat';
import type { CollectionEntry } from 'astro:content';

interface Props {
  news: CollectionEntry<'news'>;
}

const { news } = Astro.props;

// Renderovat markdown obsah
const { Content } = await news.render();

// Mapování barev na styly (statické třídy)
const colorStyles: Record<string, string> = {
  blue: 'bg-blue-50 border-blue-200 hover:border-blue-300',
  orange: 'bg-orange-50 border-orange-200 hover:border-orange-300',
  green: 'bg-green-50 border-green-200 hover:border-green-300',
  red: 'bg-red-50 border-red-200 hover:border-red-300',
  yellow: 'bg-yellow-50 border-yellow-200 hover:border-yellow-300',
  purple: 'bg-purple-50 border-purple-200 hover:border-purple-300'
};

const iconBgStyles: Record<string, string> = {
  blue: 'bg-blue-500',
  orange: 'bg-orange-500',
  green: 'bg-green-500',
  red: 'bg-red-500',
  yellow: 'bg-yellow-500',
  purple: 'bg-purple-500'
};

const cardStyle = colorStyles[news.data.color] ?? colorStyles.blue;
const iconStyle = iconBgStyles[news.data.color] ?? iconBgStyles.blue;
---

<article id={`news-${news.id}`} class={`rounded-xl border-2 ${cardStyle} p-5 transition-all shadow-sm hover:shadow-md scroll-mt-24`}>
  <div class="flex items-start gap-4">
    <!-- Ikona -->
    <div class={`w-11 h-11 ${iconStyle} rounded-lg flex items-center justify-center shrink-0 shadow-sm`}>
      <Icon name={news.data.icon} class="w-6 h-6 text-white" />
    </div>

    <!-- Obsah -->
    <div class="flex-1 min-w-0">
      <!-- Nadpis a datum -->
      <div class="flex items-start justify-between gap-2 mb-2">
        <h3 class="font-bold text-lg text-gray-900 leading-tight">
          {news.data.title}
        </h3>
        <time class="text-xs text-gray-500 whitespace-nowrap mt-0.5">
          {formatDateShort(news.data.date.toISOString())}
        </time>
      </div>

      <!-- Markdown obsah -->
      <div class="prose prose-sm max-w-none text-gray-700 [&>p]:mb-2 [&>p:last-child]:mb-0 [&>ul]:mb-2 [&>strong]:text-gray-900 [&>strong]:font-semibold">
        <Content />
      </div>
    </div>
  </div>
</article>
