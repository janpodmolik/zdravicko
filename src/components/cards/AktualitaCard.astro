---
/**
 * AktualitaCard - Komponenta pro zobrazení jedné aktuality
 *
 * Zobrazuje kartu aktuality s ikonou, nadpisem, datem a markdown obsahem.
 * Barva karty se mění podle typu aktuality.
 *
 * @component
 */
import { Icon } from 'astro-icon/components';
import { formatDateShort } from '../../utils/dateFormat';
import { getNewsCardClasses, getNewsIconBg } from '../../utils/newsColors';
import type { CollectionEntry } from 'astro:content';

interface Props {
  /** Aktualita z content kolekce */
  news: CollectionEntry<'news'>;
}

const { news } = Astro.props;

// Konstanta pro ID prefix
const NEWS_ID_PREFIX = 'news-';

// Renderovat markdown obsah
const { Content } = await news.render();

// Získat styly podle barvy
const cardClasses = getNewsCardClasses(news.data.color);
const iconBgClass = getNewsIconBg(news.data.color);
---

<article
  id={`${NEWS_ID_PREFIX}${news.id}`}
  class:list={[
    'rounded-xl border-2 p-5 transition-all shadow-sm hover:shadow-md scroll-mt-24',
    cardClasses
  ]}
>
  <div class="flex items-start gap-4">
    <!-- Ikona -->
    <div class:list={[
      'w-11 h-11 rounded-lg flex items-center justify-center shrink-0 shadow-sm',
      iconBgClass
    ]}>
      <Icon name={news.data.icon} class="w-6 h-6 text-white" />
    </div>

    <!-- Obsah -->
    <div class="flex-1 min-w-0">
      <!-- Nadpis a datum -->
      <div class="flex items-start justify-between gap-2 mb-2">
        <h3 class="font-bold text-lg text-gray-900 leading-tight">
          {news.data.title}
        </h3>
        <time class="text-xs text-gray-500 whitespace-nowrap mt-0.5">
          {formatDateShort(news.data.date.toISOString())}
        </time>
      </div>

      <!-- Markdown obsah -->
      <div class="prose prose-sm max-w-none text-gray-700 [&>p]:mb-2 [&>p:last-child]:mb-0 [&>ul]:mb-2 [&>strong]:text-gray-900 [&>strong]:font-semibold">
        <Content />
      </div>
    </div>
  </div>
</article>
