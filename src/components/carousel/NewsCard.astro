---
/**
 * Carousel karta pro aktuality
 * Optimalizovaná pro horizontální scrollování
 */
import { Icon } from 'astro-icon/components';
import type { CollectionEntry } from 'astro:content';

interface Props {
  news: CollectionEntry<'news'>;
}

const { news } = Astro.props;
const { title, color, icon, date } = news.data;

// Renderování obsahu
const { Content } = await news.render();

// Formátování data
const dateFormatter = new Intl.DateTimeFormat('cs-CZ', {
  day: 'numeric',
  month: 'numeric',
  year: 'numeric'
});
const formattedDate = dateFormatter.format(new Date(date));

// Mapování barev
const colorStyles = {
  blue: {
    bg: 'bg-blue-50',
    border: 'border-blue-200',
    icon: 'text-blue-600',
    title: 'text-blue-900',
    text: 'text-blue-800'
  },
  orange: {
    bg: 'bg-orange-50',
    border: 'border-orange-200',
    icon: 'text-orange-600',
    title: 'text-orange-900',
    text: 'text-orange-800'
  },
  green: {
    bg: 'bg-green-50',
    border: 'border-green-200',
    icon: 'text-green-600',
    title: 'text-green-900',
    text: 'text-green-800'
  },
  red: {
    bg: 'bg-red-50',
    border: 'border-red-200',
    icon: 'text-red-600',
    title: 'text-red-900',
    text: 'text-red-800'
  },
  yellow: {
    bg: 'bg-yellow-50',
    border: 'border-yellow-200',
    icon: 'text-yellow-600',
    title: 'text-yellow-900',
    text: 'text-yellow-800'
  },
  purple: {
    bg: 'bg-purple-50',
    border: 'border-purple-200',
    icon: 'text-purple-600',
    title: 'text-purple-900',
    text: 'text-purple-800'
  }
};

const styles = colorStyles[color];
---

<a
  href={`/aktuality#news-${news.id}`}
  class:list={[
    'flex-none w-[300px] md:w-[360px] p-5 md:p-6',
    'border-2 rounded-xl snap-start',
    'hover:shadow-md transition-shadow',
    'flex flex-col',
    'cursor-pointer',
    styles.bg,
    styles.border
  ]}
>
  <!-- Header s ikonou a datem -->
  <div class="flex items-start gap-3 mb-4">
    <div class:list={['shrink-0', styles.icon]}>
      <Icon name={icon} class="w-7 h-7 md:w-8 md:h-8" />
    </div>
    <div class="flex-1 min-w-0">
      <h3 class:list={['font-bold text-base md:text-lg mb-1', styles.title]}>
        {title}
      </h3>
      <p class="text-xs md:text-sm text-gray-600">
        {formattedDate}
      </p>
    </div>
  </div>

  <!-- Obsah aktuality - omezeno na 4 řádky -->
  <div class:list={['prose prose-sm max-w-none flex-1', styles.text]}>
    <div class="line-clamp-4">
      <Content />
    </div>
  </div>
</a>
