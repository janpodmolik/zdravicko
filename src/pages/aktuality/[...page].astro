---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/common/Header.astro';
import MobileMenu from '../../components/common/MobileMenu.astro';
import PageHeader from '../../components/common/PageHeader.astro';
import AktualitaCard from '../../components/cards/AktualitaCard.astro';
import Pagination from '../../components/common/Pagination.astro';
import EmptyState from '../../components/common/EmptyState.astro';
import Footer from '../../components/common/Footer.astro';
import { getPublishedNews } from '../../utils/contentHelpers';
import type { Page, GetStaticPathsOptions } from 'astro';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const allNews = await getPublishedNews();
  return paginate(allNews, { pageSize: 10 });
}

type Props = {
  page: Page<CollectionEntry<'news'>>;
};

const { page } = Astro.props;
---

<Layout
  title="Aktuality - Zdravíčko"
  description="Aktuální informace z naší dětské ordinace - důležitá oznámení, změny ordinačních hodin a další novinky"
>
  <Header activePage="aktuality" />
  <MobileMenu activePage="aktuality" />

  <main>
    <PageHeader
      title="Aktuality"
      description="Aktuální informace z naší ordinace"
      gradient={true}
    />

    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          {page.data.length > 0 ? (
            <>
              <div class="space-y-4">
                {page.data.map((news) => (
                  <AktualitaCard news={news} />
                ))}
              </div>

              <Pagination page={page} baseUrl="/aktuality" />
            </>
          ) : (
            <EmptyState
              icon="mdi:newspaper-variant-outline"
              message="Momentálně nejsou k dispozici žádné aktuality"
            />
          )}
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
