---
import Layout from '../layouts/Layout.astro';
import Header from '../components/common/Header.astro';
import MobileMenu from '../components/common/MobileMenu.astro';
import PageHeader from '../components/common/PageHeader.astro';
import Footer from '../components/common/Footer.astro';
import ServiceCard from '../components/cards/ServiceCard.astro';
import CTAButtons from '../components/common/CTAButtons.astro';
import { getCollection } from 'astro:content';
import type { ServiceColor } from '../data/services';

// Načíst publikované služby a seřadit podle order
const allServices = await getCollection('services', ({ data }) => {
  return data.published !== false;
});

const services = allServices
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999))
  .map(service => ({
    id: service.id,
    title: service.data.title,
    slug: service.slug,
    excerpt: service.data.excerpt,
    icon: service.data.icon,
    color: service.data.color as ServiceColor,
    duration: service.data.duration,
    price: service.data.price,
  }));
---

<Layout
  title="Naše služby - Zdravíčko"
  description="Kompletní přehled našich služeb - preventivní prohlídky, očkování, akutní péče a další"
>
  <Header activePage="sluzby" />
  <MobileMenu activePage="sluzby" />

  <main>
    <PageHeader
      title="Naše služby"
      description="Poskytujeme kompletní pediatrickou péči pro děti všech věkových kategorií. Od preventivních prohlídek až po akutní péči - vždy s individuálním přístupem."
      badge={{ icon: 'mdi:medical-bag', text: 'Komplexní péče' }}
    />

    <!-- Services Grid -->
    <section class="py-20 bg-white">
      <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {services.map((service) => (
              <ServiceCard service={service} />
            ))}
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="max-w-3xl mx-auto text-center">
          <h2 class="text-3xl font-bold text-gray-900 mb-4">
            Potřebujete poradit?
          </h2>
          <p class="text-lg text-gray-600 mb-8">
            Nejste si jistí, kterou službu potřebujete? Rádi vám poradíme a pomůžeme vybrat tu správnou péči pro vaše dítě.
          </p>
          <CTAButtons phoneLabel="Zavolejte nám" emailLabel="Napište nám" />
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
